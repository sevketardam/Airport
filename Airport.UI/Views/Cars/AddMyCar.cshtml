@{
    Layout = "_PanelLayout";
}
@model AddMyCarsVM

<form id="addMyCarForm" method="post" asp-route="AddCar">
    <div class="row">

        <div class="col-sm-4 mb-3">
            <label>Brands</label>
            <select class="form-control select2-multiple" id="carBrands" name="Brand" data-width="100%">
                <option disabled selected>Select Brand</option>
                @foreach (var item in Model.CarBrands)
                {
                    <option value="@item.Id">@item.CarBrandName</option>
                }
            </select>
        </div>
        <div class="col-sm-4 mb-3">
            <label>Model</label>
            <select class="form-control select2-multiple" id="carModels" name="Model" data-width="100%">
                <option disabled selected>Select Model</option>

            </select>
        </div>
        <div class="col-sm-4 mb-3">
            <label>Series</label>
            <select class="form-control select2-multiple" id="carSeries" name="Series" data-width="100%">
                <option disabled selected>Select Series</option>
            </select>
        </div>
        <div class="col-sm-4 mb-3">
            <label>Trim</label>
            <select class="form-control select2-multiple" id="carTrims" name="Trim" data-width="100%">
                <option disabled selected>Select Trim</option>

            </select>
        </div>
        <div class="col-sm-4 mb-3">
            <label>Class</label>
            <select class="form-control select2-multiple" id="carClasses" name="Class" data-width="100%">
                <option disabled selected>Select Class</option>
            </select>
        </div>
        <div class="col-sm-4 mb-3">
            <label>Type</label>
            <select class="form-control select2-multiple" id="carTypes" name="Type" data-width="100%">
                <option disabled selected>Select Type</option>
            </select>
        </div>
        <div class="col-sm-4 mb-3">
            <div class="form-group position-relative error-l-50">
                <label>Max. Passengers</label>
                <input type="number" class="form-control" value="0" name="MaxPassenger" required="">
            </div>
        </div>
        <div class="col-sm-2 mb-3">
            <div class="form-group position-relative error-l-50">
                <label>Suitcase</label>
                <input type="number" class="form-control" value="0" name="SuitCase" required="">
            </div>
        </div>
        <div class="col-sm-2 mb-3">
            <div class="form-group position-relative error-l-50">
                <label>Small Bags</label>
                <input type="number" class="form-control" value="0" name="SmallBags" required="">
            </div>
        </div>
        <div class="col-sm-4 mb-3">
            <label>Service List</label>
            <select class="form-control select2-multiple" name="Service" data-width="100%">
                <option disabled selected>Select Service List</option>
                @foreach (var item in Model.ServiceItems)
                {
                    <option value="@item.Id">@item.ServiceName</option>
                }
            </select>
        </div>

        <div class="col-md-12">
            <div class="text-right">
                <button class="btn btn-secondary" type="submit">
                    Add My Car
                </button>
            </div>
        </div>
    </div>
</form>

@section pageJs{
    <script>
        $('#carBrands').on("change", function () {
            var value = $(this).val();
            $.ajax({
                url: '@Url.Action(nameof(Airport.UI.Controllers.CarsController.GetModels))',
                type: "POST",
                data: {id:value},
                success: function (response) {
                    if(response.result == 200){
                        $('#carModels').html("");
                        $('#carModels').append(`<option disabled selected>Select Model</option>`)
                        $.each(response.models,function(key,value){
                            $('#carModels').append(`<option value="${value.id}">${value.carModelName}</option>`)
                        })
                    }
                }
            });
        })

        $('#carModels').on("change", function () {
            var value = $(this).val();
            $.ajax({
                url: '@Url.Action(nameof(Airport.UI.Controllers.CarsController.GetSeries))',
                type: "POST",
                data: { id: value },
                success: function (response) {
                    if (response.result == 200) {
                        $('#carSeries').html("");
                        $('#carSeries').append(`<option disabled selected>Select Series</option>`)
                        $.each(response.series, function (key, value) {
                            $('#carSeries').append(`<option value="${value.id}">${value.carSeriesName}</option>`)
                        })
                    }
                }
            });
        })

        $('#carSeries').on("change", function () {
            var value = $(this).val();
            $.ajax({
                url: '@Url.Action(nameof(Airport.UI.Controllers.CarsController.GetTrims))',
                type: "POST",
                data: { id: value },
                success: function (response) {
                    if (response.result == 200) {
                        $('#carTrims').html("");
                        $('#carTrims').append(`<option disabled selected>Select Trim</option>`)
                        $.each(response.trims, function (key, value) {
                            $('#carTrims').append(`<option value="${value.id}">${value.carTrimName}</option>`)
                        })
                    }
                }
            });
        })

        $('#carTrims').on("change", function () {
            var value = $(this).val();
            $.ajax({
                url: '@Url.Action(nameof(Airport.UI.Controllers.CarsController.GetClassAndTypes))',
                type: "POST",
                data: { id: value },
                success: function (response) {
                    if (response.result == 200) {
                        $('#carClasses').html("");
                        $('#carClasses').append(`<option disabled selected>Select Class</option>`)
                        $.each(response.classes, function (key, value) {
                            $('#carClasses').append(`<option value="${value.id}">${value.carClassName}</option>`)
                        })

                        $('#carTypes').html("");
                        $('#carTypes').append(`<option disabled selected>Select Type</option>`)
                        $.each(response.types, function (key, value) {
                            $('#carTypes').append(`<option value="${value.id}">${value.carTypeName}</option>`)
                        })
                    }
                }
            });
        })

        //$('#addMyCarForm').on("submit", function (e) {
        //    e.preventDefault();
        //    var formData = $(this).serialize()
        //    $.ajax({
        //        url: '@Url.Action(nameof(Airport.UI.Controllers.CarsController))',
        //        type: "POST",
        //        data: formData,
        //        success: function (response) {
        //            if (response.result == 1) {
        //                Swal.fire({
        //                    icon: 'success',
        //                    title: 'Success',
        //                    text: 'Successfully Added Car',
        //                }).then(() => {
        //                    location.href = "/panel/mycars";
        //                })
        //            }
        //        }
        //    });
        //})

    </script>
}
