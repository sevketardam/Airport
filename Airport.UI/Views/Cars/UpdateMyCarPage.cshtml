@{
    Layout = "_PanelLayout";
}
@model UpdateMyCarVM

<form id="updateMyCarForm">
    <div class="row">

        <div class="col-sm-4 mb-3">
            <label>Brands</label>
            <select class="form-control select2-multiple" id="carBrands" name="Brand" data-width="100%">
                <option disabled selected>Select Brand</option>
                @foreach (var item in Model.Brands)
                {
                    if (item.Id == Model.BrandId)
                    {
                        <option value="@item.Id" selected>@item.CarBrandName</option>
                    }
                    else
                    {
                        <option value="@item.Id">@item.CarBrandName</option>
                    }
                }
            </select>
        </div>
        <div class="col-sm-4 mb-3">
            <label>Model</label>
            <select class="form-control select2-multiple" id="carModels" name="Model" data-width="100%">
                <option disabled selected>Select Model</option>
                @foreach (var item in Model.Models)
                {
                    if (item.Id == Model.ModelId)
                    {
                        <option value="@item.Id" selected>@item.CarModelName</option>
                    }
                    else
                    {
                        <option value="@item.Id">@item.CarModelName</option>
                    }
                }
            </select>
        </div>
        <div class="col-sm-4 mb-3">
            <label>Series</label>
            <select class="form-control select2-multiple" id="carSeries" name="Series" data-width="100%">
                <option disabled selected>Select Series</option>
                @foreach (var item in Model.Series)
                {
                    if (item.Id == Model.SeriesId)
                    {
                        <option value="@item.Id" selected>@item.CarSeriesName</option>
                    }
                    else
                    {
                        <option value="@item.Id">@item.CarSeriesName</option>
                    }
                }
            </select>
        </div>
        <div class="col-sm-4 mb-3">
            <label>Trim</label>
            <select class="form-control select2-multiple" id="carTrims" name="Trim" data-width="100%">
                <option disabled selected>Select Trim</option>
                @foreach (var item in Model.Trims)
                {
                    if (item.Id == Model.TrimId)
                    {
                        <option value="@item.Id" selected>@item.CarTrimName</option>
                    }
                    else
                    {
                        <option value="@item.Id">@item.CarTrimName</option>
                    }
                }
            </select>
        </div>
        <div class="col-sm-4 mb-3">
            <label>Class</label>
            <select class="form-control select2-multiple" id="carClasses" name="Class" data-width="100%">
                <option disabled selected>Select Class</option>
                @foreach (var item in Model.Classes)
                {
                    if (item.Id == Model.ClassId)
                    {
                        <option value="@item.Id" selected>@item.CarClassName</option>
                    }
                    else
                    {
                        <option value="@item.Id">@item.CarClassName</option>
                    }
                }
            </select>
        </div>
        <div class="col-sm-4 mb-3">
            <label>Type</label>
            <select class="form-control select2-multiple" id="carTypes" name="Type" data-width="100%">
                <option disabled selected>Select Type</option>
                @foreach (var item in Model.Types)
                {
                    if (item.Id == Model.TypeId)
                    {
                        <option value="@item.Id" selected>@item.CarTypeName</option>
                    }
                    else
                    {
                        <option value="@item.Id">@item.CarTypeName</option>
                    }

                }
            </select>
        </div>
        <div class="col-sm-4 mb-3">
            <div class="form-group position-relative error-l-50">
                <label>Max. Passengers</label>
                <input type="number" min="1" class="form-control" value="@Model.MaxPassenger" name="MaxPassenger" required="">
            </div>
        </div>
        <div class="col-sm-2 mb-3">
            <div class="form-group position-relative error-l-50">
                <label>Suitcase</label>
                <input type="number" min="0" class="form-control" value="@Model.SuitCase" name="SuitCase" required="">
            </div>
        </div>
        <div class="col-sm-2 mb-3">
            <div class="form-group position-relative error-l-50">
                <label>Small Bags</label>
                <input type="number" min="0" class="form-control" value="@Model.SmallBags" name="SmallBags" required="">
            </div>
        </div>
        <div class="col-sm-4 mb-3">
            <label>Service List</label>
            <select class="form-control select2-multiple" name="Service" data-width="100%">
                <option disabled selected>Select Service List</option>
                @foreach (var item in Model.Services)
                {
                    if (item.Id == Model.ServiceId)
                    {
                        <option value="@item.Id" selected>@item.ServiceName</option>
                    }
                    else
                    {
                        <option value="@item.Id">@item.ServiceName</option>
                    }            
                }
            </select>
        </div>

        <div class="col-sm-4 mb-3 _Pos_Rel">
            <label>Select Driver</label>
            <select class="form-control select2-multiple" name="DriverId" data-width="100%">
                <option disabled selected>Select Driver</option>
                @foreach (var item in Model.Drivers)
                {
                    <option value="@item.Id">@item.Name</option>
                }
            </select>
        </div>

        <div class="col-md-2 _Pos_Rel">
            <div class="custom-control custom-checkbox mb-4">
                <input type="checkbox" class="custom-control-input" id="wifiCheckbox" @(Model.Wifi ? "checked" : "") name="Wifi" value="true">
                <label class="custom-control-label" for="wifiCheckbox">
                    Free Wifi
                </label>
            </div>
        </div>

        <div class="col-md-2 _Pos_Rel">
            <div class="custom-control custom-checkbox mb-4">
                <input type="checkbox" class="custom-control-input" id="waterCheckbox" @(Model.Water ? "checked" : "") name="Water" value="true">
                <label class="custom-control-label" for="waterCheckbox">
                    Water
                </label>
            </div>
        </div>


        <div class="col-md-2 _Pos_Rel">
            <div class="custom-control custom-checkbox mb-4">
                <input type="checkbox" class="custom-control-input" id="chargerChecbox" @(Model.Charger ? "checked" : "") name="Charger" value="true">
                <label class="custom-control-label" for="chargerChecbox">
                    Charger
                </label>
            </div>
        </div>


        <div class="col-md-2 _Pos_Rel">
            <div class="custom-control custom-checkbox mb-4">
                <input type="checkbox" class="custom-control-input" id="disabledCheckbox" @(Model.Disabled ? "checked" : "") name="Disabled" value="true">
                <label class="custom-control-label" for="disabledCheckbox">
                    Disabled
                </label>
            </div>
        </div>


        <div class="col-md-2 _Pos_Rel">
            <div class="custom-control custom-checkbox mb-4">
                <input type="checkbox" class="custom-control-input" id="armoredCheckbox" @(Model.Armored ? "checked" : "") name="Armored" value="true">
                <label class="custom-control-label" for="armoredCheckbox">
                    Armored
                </label>
            </div>
        </div>


        <div class="col-md-2 _Pos_Rel">
            <div class="custom-control custom-checkbox mb-4">
                <input type="checkbox" class="custom-control-input" id="partitionCheckbox" @(Model.Partition ? "checked" : "") name="Partition" value="true">
                <label class="custom-control-label" for="partitionCheckbox">
                    Partition
                </label>
            </div>
        </div>

        <div class="col-md-12">
            <div class="text-right">
                <button class="btn btn-secondary" type="submit">
                    Update My Car
                </button>
            </div>
        </div>
    </div>
</form>

@section pageJs{
    <script>
        $('#carBrands').on("change", function () {
            var value = $(this).val();
            $.ajax({
                url: '@Url.Action(nameof(Airport.UI.Controllers.CarsController.GetModels))',
                type: "POST",
                data: { id: value },
                success: function (response) {
                    if (response.result == 200) {
                        $('#carModels').html("");
                        $('#carModels').append(`<option disabled selected>Select Model</option>`)
                        $.each(response.models, function (key, value) {
                            $('#carModels').append(`<option value="${value.id}">${value.carModelName}</option>`)
                        })
                    }
                }
            });
        })

        $('#carModels').on("change", function () {
            var value = $(this).val();
            $.ajax({
                url: '@Url.Action(nameof(Airport.UI.Controllers.CarsController.GetSeries))',
                type: "POST",
                data: { id: value },
                success: function (response) {
                    if (response.result == 200) {
                        $('#carSeries').html("");
                        $('#carSeries').append(`<option disabled selected>Select Series</option>`)
                        $.each(response.series, function (key, value) {
                            $('#carSeries').append(`<option value="${value.id}">${value.carSeriesName}</option>`)
                        })
                    }
                }
            });
        })

        $('#carSeries').on("change", function () {
            var value = $(this).val();
            $.ajax({
                url: '@Url.Action(nameof(Airport.UI.Controllers.CarsController.GetTrims))',
                type: "POST",
                data: { id: value },
                success: function (response) {
                    if (response.result == 200) {
                        $('#carTrims').html("");
                        $('#carTrims').append(`<option disabled selected>Select Trim</option>`)
                        $.each(response.trims, function (key, value) {
                            $('#carTrims').append(`<option value="${value.id}">${value.carTrimName}</option>`)
                        })
                    }
                }
            });
        })

        $('#carTrims').on("change", function () {
            var value = $(this).val();
            $.ajax({
                url: '@Url.Action(nameof(Airport.UI.Controllers.CarsController.GetClassAndTypes))',
                type: "POST",
                data: { id: value },
                success: function (response) {
                    if (response.result == 200) {
                        $('#carClasses').html("");
                        $('#carClasses').append(`<option disabled selected>Select Class</option>`)
                        $.each(response.classes, function (key, value) {
                            $('#carClasses').append(`<option value="${value.id}">${value.carClassName}</option>`)
                        })

                        $('#carTypes').html("");
                        $('#carTypes').append(`<option disabled selected>Select Type</option>`)
                        $.each(response.types, function (key, value) {
                            $('#carTypes').append(`<option value="${value.id}">${value.carTypeName}</option>`)
                        })
                    }
                }
            });
        })

        $('#updateMyCarForm').on("submit", function (e) {
            e.preventDefault();
            var formData = $(this).serialize()
            $.ajax({
                url: '@Url.Action(nameof(Airport.UI.Controllers.CarsController.UpdateMyCar))',
                type: "POST",
                data: formData + "&id=" + @Model.Id,
                success: function (response) {
                    if (response.result == 1) {
                        Swal.fire({
                            icon: 'success',
                            title: 'Success',
                            text: 'Successfully Update Service',
                        }).then(() => {
                            location.href = "/panel/mycars";
                        })
                    }
                }
            });
        })

    </script>
}